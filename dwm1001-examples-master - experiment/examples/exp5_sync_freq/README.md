# 实验5：同步频率（锚点后台功耗）

## 实验目的
改同步周期，观测锚点侧**后台同步**带来的功耗差。

## 实验配置

### A组（基线）
- **同步周期**: 1秒
- **同步类型**: 双源 PPS+PTP
- **特点**: 基线配置，同步频率高，功耗略高

### B组（放宽）
- **同步周期**: 2秒
- **同步类型**: 双源 PPS+PTP
- **特点**: 同步频率降低，功耗略降，需确认定位精度是否受影响

## 实验参数

- **每个模式运行时间**: 150秒
- **模式切换延迟**: 10秒
- **记录间隔**: 1秒
- **基线PHY配置**: 6.8Mbps / PRF 64MHz / PL=64 / SFD=standard(8)

## 记录指标

每个测量周期记录以下数据：
- **Sync Count**: 同步事件计数（PPS+PTP）
- **PTP Offset**: PTP偏移量（纳秒），用于评估定位精度
- **PPS Jitter**: PPS抖动（纳秒），用于评估定位精度
- **Sync Power**: 同步相关功耗（相对单位/秒）
- **Actual Sync Rate**: 实际同步频率
- **RSSI, SNR**: 接收质量指标

## 预期结果

- **B组**: 功耗略降（同步频率降低）
- **定位精度**: 需通过 `ptp_offset_ns` 和 `pps_jitter_ns` 观测是否受影响
- **同步功耗**: B组的同步功耗应明显低于A组

## 文件结构

```
exp5_sync_freq/
├── main.c              # 主程序，负责初始化和模式切换监控
├── ss_resp_main.c      # SS TWR responder逻辑和数据记录
├── ss_resp_main.h      # 头文件定义
├── UART/               # UART驱动
│   ├── UART.c
│   └── UART.h
└── config/             # SDK配置文件
    └── sdk_config.h
```

## 使用方法

1. 编译项目（使用Keil或SES）
2. 烧录到DWM1001设备（作为锚点/responder）
3. 通过UART观察输出数据
4. 实验将自动在Sync模式A和B之间切换
5. 每个模式运行150秒后自动切换到下一个模式

## 输出格式

实验会输出以下信息：
- 模式切换通知和同步周期信息
- 每10次成功传输的详细信息（包括PTP offset和PPS jitter）
- 每秒的统计摘要
- 模式切换时的完整统计报告（包括同步功耗和定位精度对比）

## 注意事项

- 此实验针对**锚点（responder）**，需要配合initiator使用
- 实验开始前确保系统已稳定
- 模式切换期间会有10秒延迟
- 所有统计数据会在模式切换时打印
- **关键指标**：ptp_offset_ns和pps_jitter_ns用于评估定位精度
- **注意**：本实验中的PPS和PTP是模拟的。在实际系统中，这些应该是真实的硬件同步信号


