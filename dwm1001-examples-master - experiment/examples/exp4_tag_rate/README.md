# 实验4：标签上报频度（能量/次定位）

## 实验目的
改 `r_tag_hz`，对比**平均功耗**与**每次定位能量**。

## 实验配置

### A组（低频）
- **上报频率**: 2 Hz
- **延迟**: 500 ms
- **特点**: 低频上报，可能能量/次定位更高（摊薄效应不足）

### B组（基线）
- **上报频率**: 10 Hz
- **延迟**: 100 ms
- **特点**: 基线配置，平均功耗更高但每次定位能量变化不大

## 实验参数

- **每个模式运行时间**: 150秒
- **模式切换延迟**: 10秒
- **记录间隔**: 1秒
- **基线PHY配置**: 6.8Mbps / PRF 64MHz / PL=64 / SFD=standard(8)

## 记录指标

每个测量周期记录以下数据：
- **Localization Count**: 成功定位计数
- **Energy per Localization**: 每次定位能量（相对单位）
- **Avg Power**: 平均功耗（相对单位/秒）
- **Actual Rate**: 实际上报频率
- **Distance**: 计算的距离
- **RSSI, RXPACC, SNR**: 接收质量指标

## 预期结果

- **B组**: 平均功耗更高（10Hz vs 2Hz）
- **每次定位能量**: 变化不大
- **若存在固定背景功耗**: A组的"能量/次"可能更高（摊薄效应不足）

## 文件结构

```
exp4_tag_rate/
├── main.c              # 主程序，负责初始化和模式切换监控
├── ss_init_main.c      # SS TWR initiator逻辑和数据记录
├── ss_init_main.h      # 头文件定义
├── UART/               # UART驱动
│   ├── UART.c
│   └── UART.h
└── config/             # SDK配置文件
    └── sdk_config.h
```

## 使用方法

1. 编译项目（使用Keil或SES）
2. 烧录到DWM1001设备（作为标签/initiator）
3. 通过UART观察输出数据
4. 实验将自动在Tag Rate模式A和B之间切换
5. 每个模式运行150秒后自动切换到下一个模式

## 输出格式

实验会输出以下信息：
- 模式切换通知和上报频率信息
- 每10次成功定位的详细信息
- 每秒的统计摘要
- 模式切换时的完整统计报告（包括能量/次定位对比）

## 注意事项

- 此实验针对**标签（initiator）**，需要配合responder使用
- 实验开始前确保系统已稳定
- 模式切换期间会有10秒延迟
- 所有统计数据会在模式切换时打印
- **关键指标**：energy_per_localization用于评估每次定位的能量消耗


